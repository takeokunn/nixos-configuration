# markdownテキスト更新コマンド

AIが生成した文章をmarkdownファイルとして作成・更新するスラッシュコマンド。既存ファイルの更新を優先し、Living Documentとして完成された状態を維持します。

## 使用方法

### 基本構文

```bash
/markdown [ファイルパス] [オプション]
```

**実行例**

```bash
# 自動判定でファイル出力
/markdown

# 指定ファイルに出力
/markdown ./docs/api-spec.md

# 強制更新・新規作成
/markdown ./docs/readme.md --update
/markdown ./docs/feature.md --create
```

**パラメータ**

- `ファイルパス`: 出力先（省略時は自動生成）
- `--update`: 既存ファイル強制更新
- `--create`: 新規ファイル強制作成

### ファイル判定ロジック

**自動ファイル名生成**（パス省略時）

- 内容テーマ分析 → 既存ファイル検索 → `{テーマ}-{日付}.md`形式で生成

**更新vs新規判定**

- **更新**: 同テーマファイル存在 + 内容類似度70%以上
- **新規**: 類似度30%未満 OR 独立テーマ OR `--create`指定

## 技術仕様

### 処理フロー

```mermaid
flowchart TD
    A[/markdown実行] --> B{パス指定?}
    B -->|Yes| C[指定パス]
    B -->|No| D[自動生成]
    C --> E[ファイル確認]
    D --> E
    E --> F{存在?}
    F -->|No| G[Write tool]
    F -->|Yes| H[類似度分析]
    H --> I{70%以上?}
    I -->|Yes| J[Edit tool]
    I -->|No| G
    G --> K[完了]
    J --> K

    style A fill:#e1f5fe
    style G fill:#c8e6c9
    style J fill:#fff3e0
```

### 実装詳細

**ファイル操作**

- Write/Edit toolによる安全な操作
- UTF-8エンコーディング、LF改行
- 原子的書き込み（全成功 or 全失敗）

**エラー処理**

- パーミッションエラー、容量不足、ファイルロック検出

**設計原則**

- 単一責任: 1ファイル = 1目的
- 冪等性: 同入力 → 同結果
- 原子性: 完全成功/失敗

## 文書作成ガイドライン

### 記載必須内容

- **仕様・要求事項**: 機能的・非機能的要件
- **技術的背景**: 実装前提知識、アーキテクチャ
- **使用方法**: 操作手順、パラメータ、制約

### 記載禁止内容

- 修正履歴・変更ログ
- 検討過程・議論経緯
- 変更理由・過去バージョン比較

## Claude Code統合

- スラッシュコマンドとして環境統合
- 対話型・バッチ実行両対応
- 既存ファイル操作toolとの連携
